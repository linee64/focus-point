
import sys
import os
sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from backend.services.summarizer import SummarizationService

def test_filter():
    summarizer = SummarizationService()
    
    # Тестовый текст с мусором, математикой и теорией
    test_text = """
    Всем привет, ребята! С вами Реальные Венатор. Сегодня мы разберем важную тему - квадратичная функция.
    Квадратичная функция — это функция вида y = ax^2 + bx + c, где a не равно нулю.
    Давайте найдем вершину. Квадрате минус 6 умножить на 3 и плюс 5 в результате у нас получится 9 минус 18.
    Это будет -9 минус 9 плюс 5 будет -4 в результате вершина параболы у нас будет 3 и минус 4.
    3 и минус 4 одну точку нашли — очень важная .
    Основное правило: если коэффициент a больше нуля, то ветви параболы направлены вверх.
    Это очень важно запомнить для решения задач.
    Также стоит отметить, что графиком квадратичной функции является парабола.
    Подписывайтесь на канал, ставьте лайки!
    """
    
    print("\n" + "="*50)
    print("ВХОДНОЙ ТЕКСТ (С МУСОРОМ):")
    print("-" * 50)
    print(test_text.strip())
    print("="*50)
    
    result = summarizer.summarize(test_text)
    
    print("\nРЕЗУЛЬТАТ РАБОТЫ ФИЛЬТРА (КОНСПЕКТ):")
    print("-" * 50)
    print(result)
    print("="*50)

    # Проверка на отсутствие мусора
    noise_phrases = ["3 и минус 4", "Венатор", "Подписывайтесь", "9 минус 18"]
    found_noise = [p for p in noise_phrases if p.lower() in result.lower()]
    
    if not found_noise:
        print("\n✅ ТЕСТ ПРОЙДЕН: Математический и блогерский шум успешно отфильтрован!")
    else:
        print(f"\n❌ ТЕСТ НЕ ПРОЙДЕН: В тексте остался шум: {found_noise}")

if __name__ == "__main__":
    test_filter()
